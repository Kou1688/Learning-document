# 1.进程与线程的区别

https://www.bilibili.com/video/BV1Wr4y1P7Yr?spm_id_from=333.999.0.0

+ 这是一段程序

  ![image-20220604232928613](https://typora-1259727047.cos.ap-nanjing.myqcloud.com/img/2022/image-20220604232928613.png)

  程序由代码的形式被编写好之后被放在硬盘里进行保存，当cpu从硬盘中读取程序到内存中，这个在内存中的可执行程序实例就是进程。一个程序被多次读取或多个程序被读取也就会创建出更多的进程。

+ 内存每个地方都有着对应的内存地址方便cpu进行访问，每个进程内部都有着自己对应的虚拟地址空间，在进程里的访问就可以通过虚拟地址来进行。进程是程序执行的完整单位，进程与进程之间的通信需要通过进程间通信(IPC)进行系统调用。

+ 每个进程都以为自己独占着整个内存，不需要关心其他进程位置，这样就将进程分隔开来。进程里会有一个加载的程序，里面会有一个程序计数器，记录当前程序执行的位置，这里的一个执行流就是一个线程，多个线程则需要有多个程序计数器，每个线程独自运行，线程内还会有寄存器与堆栈等记录当前线程的状态信息，线程间会共享地址空间等信息。

+ ![image-20220604234724497](https://typora-1259727047.cos.ap-nanjing.myqcloud.com/img/2022/image-20220604234724497.png)

  线程可以看作进程中的进程。这是一个文本编辑器，相当于一个进程，假如我们在最后一行敲一个回车然后添加相应内容，这个时候该进程需要接受键盘的输入事件，还需要将用户输入的内容保存在内存或或硬盘中，最后还需要将更改的内容渲染以供用户浏览，这三个事件应该并行执行，并且需要访问同一个文档，所以肯定在同一个进程中，所以这时候就需要引入更轻量级的线程概念，三个事件分别对应交互线程、存储线程、渲染线程。

+ ![image-20220604235941191](https://typora-1259727047.cos.ap-nanjing.myqcloud.com/img/2022/image-20220604235941191.png)

  线程是并行的最小单位，假如计算机只有一个单核cpu，cpu就会轮流去执行每个线程，每次单个计算的时间称为CPU时间片。线程在等待cpu执行时称为就绪态，被cpu执行时转为运行状态，假如线程正在执行中，程序向硬盘发送了访问请求然后等待，cpu空转，线程变为阻塞状态，cpu去执行其他线程，硬盘数据回复，线程再次转为就绪态。cpu会在内核中为每个线程提供虚拟cpu，这样每个线程都会认为自己在独占着cpu，这样就不需要去考虑时间片轮转问题。